<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>They Say Don't Use the AUR | relg.uk</title><meta name=keywords content><meta name=description content="If I had to guess, why people use an Arch-based system, I would guess a big reason would be the AUR — even though it is not officially supported. It is a big part of the community and the appeal of Arch. This is a story how the AUR can break some things and the reason it is not officially supported.
It all started with a normal update. In my case I used the AUR helper paru to update all system packages and all AUR packages."><meta name=author content><link rel=canonical href=https://www.relg.uk/posts/they-say-dont-use-the-aur/><link crossorigin=anonymous href=/assets/css/stylesheet.min.c88963fe2d79462000fd0fb1b3737783c32855d340583e4523343f8735c787f0.css integrity="sha256-yIlj/i15RiAA/Q+xs3N3g8MoVdNAWD5FIzQ/hzXHh/A=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.min.b95bacdc39e37a332a9f883b1e78be4abc1fdca2bc1f2641f55e3cd3dabd4d61.js integrity="sha256-uVus3DnjejMqn4g7Hni+Srwf3KK8HyZB9V4809q9TWE=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://www.relg.uk/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://www.relg.uk/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://www.relg.uk/favicon-32x32.png><link rel=apple-touch-icon href=https://www.relg.uk/apple-touch-icon.png><link rel=mask-icon href=https://www.relg.uk/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.119.0"><link rel=alternate hreflang=en href=https://www.relg.uk/posts/they-say-dont-use-the-aur/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:title" content="They Say Don't Use the AUR"><meta property="og:description" content="If I had to guess, why people use an Arch-based system, I would guess a big reason would be the AUR — even though it is not officially supported. It is a big part of the community and the appeal of Arch. This is a story how the AUR can break some things and the reason it is not officially supported.
It all started with a normal update. In my case I used the AUR helper paru to update all system packages and all AUR packages."><meta property="og:type" content="article"><meta property="og:url" content="https://www.relg.uk/posts/they-say-dont-use-the-aur/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-10-08T17:41:04+02:00"><meta property="article:modified_time" content="2023-10-08T17:41:04+02:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="They Say Don't Use the AUR"><meta name=twitter:description content="If I had to guess, why people use an Arch-based system, I would guess a big reason would be the AUR — even though it is not officially supported. It is a big part of the community and the appeal of Arch. This is a story how the AUR can break some things and the reason it is not officially supported.
It all started with a normal update. In my case I used the AUR helper paru to update all system packages and all AUR packages."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://www.relg.uk/posts/"},{"@type":"ListItem","position":2,"name":"They Say Don't Use the AUR","item":"https://www.relg.uk/posts/they-say-dont-use-the-aur/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"They Say Don't Use the AUR","name":"They Say Don\u0027t Use the AUR","description":"If I had to guess, why people use an Arch-based system, I would guess a big reason would be the AUR — even though it is not officially supported. It is a big part of the community and the appeal of Arch. This is a story how the AUR can break some things and the reason it is not officially supported.\nIt all started with a normal update. In my case I used the AUR helper paru to update all system packages and all AUR packages.","keywords":[],"articleBody":"If I had to guess, why people use an Arch-based system, I would guess a big reason would be the AUR — even though it is not officially supported. It is a big part of the community and the appeal of Arch. This is a story how the AUR can break some things and the reason it is not officially supported.\nIt all started with a normal update. In my case I used the AUR helper paru to update all system packages and all AUR packages. Only obs-studio-tytan652 failed when trying to compile, but I rarely use OBS Studio (it will get fixed, eventually).\nBroken Electron-based Applications When I tried to launch my note taking app Obsidian, it never started. I dropped into a shell and tried again.\n❯ obsidian /usr/lib/electron25/electron: error while loading shared libraries: libdav1d.so.6: cannot open shared object file: No such file or directory I had seem behavior like this before after an update. When you update your kernel and you are still running the old kernel. If the running (old) kernel needs to load a new module it expects the old libraries but cannot find them as only the new ones are available.\nIt is generally also a bad idea to symlink libraries. If you would symlink the old library to the location of the old one, there is no guarantee that they are even remotely compatible.\nTip 1: Don’t break your system with symlinking shared libraries.\nFor the new-kernel-old-module problem a reboot usually suffices. However, electron apps would probably not use any kernel shared libraries. To make sure anyways, I did reboot.\nTip 2: Reboot after a upgrade if libraries cannot be found.\nAfter the reboot I was still not able to launch Obsidian or any other Electron-based app.\nElectron is a framework for building desktop applications. It uses the Chromium browser engine and Node.js to make it easy to build cross-platform applications — especially, if you are already familiar with building web apps.\nWhat is Actually Missing and Where Should it Come From? Since the issue seems to come from [electon] and not Obsidian itself I looked at electron directly which yielded the same error.\nWhen looking for library dependencies for the command electron, there are two red herrings. One is, that the package electron is only a meta package to link to the latest stable version of electron The second red herring is that /usr/bin/electron25 is a shell script to exec /usr/lib/electron25/electron. So to check for the shared library dependencies, we can follow the trail like this:\n❯ which electron /usr/bin/electron ❯ ls -l /usr/bin/electron lrwxrwxrwx 1 root root 10 Jun 16 08:50 /usr/bin/electron -\u003e electron25 ❯ file /usr/bin/electron25 /usr/bin/electron25: Bourne-Again shell script, ASCII text executable ❯ cat /usr/bin/electron25 #!/usr/bin/bash […snip…] name=electron25 […snip…] exec /usr/lib/${name}/electron \"${flags[@]}\" \"$@\" ❯ file /usr/lib/electron25/electron /usr/lib/electron25/electron: ELF 64-bit LSB pie executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, for GNU/Linux 4.4.0, BuildID[sha1]=adabc98fbf2c1422ad6b6c4de371150f4fe605aa, stripped Tip 3: Find the binary that is actually run.\nTo find the libraries you can run ldd and filtered for the library name.\n❯ ldd /usr/lib/electron25/electron | grep libdav1d libdav1d.so.7 =\u003e /usr/lib/libdav1d.so.7 (0x00007f41ea424000) ❯ ls -l /usr/lib/libdav1d.so.7 lrwxrwxrwx 1 root root 17 Oct 4 17:21 /usr/lib/libdav1d.so.7 -\u003e libdav1d.so.7.0.0 ❯ pacman -F /usr/lib/libdav1d.so.7 usr/lib/libdav1d.so.7 is owned by extra/dav1d 1.3.0-1 Let’s walk through this. The binary wants libdav1d.so.7 and it can be found in /usr/lib/. The way this resolution from filename to path works is similar to how the PATH variable works. If you want to learn more about where libraries live, search for LS_LIBRARY_PATH and ld. For now, it is enough to know that the library is present at a know location, and points to another (existing) file.\nBut actually this library is not the one the error complains about. In the error above it complained about libdav1d.so.6 being absent.\nI reached out to the Arch Linux Mailing List which was very helpful. With the help of lddtree (from the package pax-utils) I could look recursively at the required libraries. Again, I filtered for the relevant library name but show 5 lines above the matches to see potential parent dependencies.\n❯ lddtree /usr/lib/electron25/electron | grep -B5 libdav1d libavcodec.so.60 =\u003e /usr/lib/libavcodec.so.60 libswresample.so.4 =\u003e /usr/lib/libswresample.so.4 libsoxr.so.0 =\u003e /usr/lib/libsoxr.so.0 libgomp.so.1 =\u003e /usr/lib/libgomp.so.1 libvpx.so.8 =\u003e /usr/lib/libvpx.so.8 libdav1d.so.6 =\u003e None -- libva-x11.so.2 =\u003e /usr/lib/libva-x11.so.2 libX11-xcb.so.1 =\u003e /usr/lib/libX11-xcb.so.1 libxcb-dri3.so.0 =\u003e /usr/lib/libxcb-dri3.so.0 libvdpau.so.1 =\u003e /usr/lib/libvdpau.so.1 libOpenCL.so.1 =\u003e /usr/lib/libOpenCL.so.1 libdav1d.so.7 =\u003e /usr/lib/libdav1d.so.7 This still shows libdav1d.so.7 at the root level of the dependencies but also libdav1d.so.6 as dependency of libavcodec.so.60. It cannot resolve the name to a library location so None gets displayed.\nSo where is this library from?\n❯ pacman -F libavcodec.so.60 extra/ffmpeg 2:6.0-12 usr/lib/libavcodec.so.60 ❯ pacman -Qi ffmpeg |grep -e Name -e Prov -e Requi Name : ffmpeg-obs Provides : ffmpeg=6.0.r12.ga6dc929 libavcodec.so=60-64 libavdevice.so=60-64 libavfilter.so=9-64 libavformat.so=60-64 libavutil.so=58-64 libpostproc.so=57-64 libswresample.so=4-64 libswscale.so=7-64 Required By : chromaprint chromium electron25 ferdium-bin firefox gst-libav krita obs-studio-tytan652 opencv peek qt5-webengine telegram-desktop thunderbird vlc-luajit Hm, do you notice something?\nTip 4: You can use ldd, lddtree (pax-utils) to find shared library dependencies that a binary need (is linked against).\nTip 5: You can use pacman -F to find the package for file and pacman -Qi to show information about a package, like actual name or which other packages require it.\nThe Culprit The library is provided by ffmpeg a widely used library for decoding of all kinds of media. But the installed version is not the regular version from the official arch (extra) repositories but ffmpeg-obs, a version from the AUR which is required by obs-studio-tytan652.\nSo why is it broken? Every time a library is updated, every program that uses it, needs to also be rebuilt to link against the latest version. If you are running only official packages from Arch Linux they take good care that if one library gets an update every program or library using it (recursively) will be updated as well to reflect the changed version. This is the reason why a partially upgraded system is unsupported. They cannot guarantee that the libraries match up.\nThe AUR on the other hand is independent from the official package repositories. If something changes in the official repos, the AUR package maintainer need to notice and react to it. If it is a binary package, they need to rebuild it themselves. If it is a package built from source it needs to be rebuilt on the users machine as well as soon as the new libraries are available (can also be done through a version increment, e.g. increase the suffix to -2).\nAt this point I had two options.\nRemove obs-studio-tytan652 and switch back to extra/ffmpeg (the officially) supported version Rebuilt ffmpeg-obs to link against the latest version of dav1d. When I realised what had happened there was already a new version of ffmpeg-obs. But I will keep this in mind for future updates.\nConclusion If this error had happened in an AUR package I would have known that I probably had to rebuild it to link to the new dependencies. In this case however, one package in the dependency chain was replaced by an unofficial one. Which made it less obvious to track down the issue.\nTip 6: Be weary what packages you replace with packages from the AUR.\n","wordCount":"1203","inLanguage":"en","datePublished":"2023-10-08T17:41:04+02:00","dateModified":"2023-10-08T17:41:04+02:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.relg.uk/posts/they-say-dont-use-the-aur/"},"publisher":{"@type":"Organization","name":"relg.uk","logo":{"@type":"ImageObject","url":"https://www.relg.uk/favicon.ico"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://www.relg.uk/ accesskey=h title="relg.uk (Alt + H)">relg.uk</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li><li><a href=https://www.relg.uk/de/ title=🇩🇪 aria-label=:de:>De</a></li></ul></span></div><ul id=menu><li><a href=https://www.relg.uk/search/ title="search (Alt + /)" accesskey=/><span>search</span></a></li><li><a href=https://www.relg.uk/archives/ title=archive><span>archive</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>They Say Don't Use the AUR</h1><div class=post-meta><span title='2023-10-08 17:41:04 +0200 +0200'>October 8, 2023</span>&nbsp;·&nbsp;6 min&nbsp;|&nbsp;<a href=https://github.com/syphdias/syphdias.github.io/edit/main/content/posts/they-say-dont-use-the-aur.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=post-content><p>If I had to guess, why people use an Arch-based system, I would guess a big
reason would be the AUR — even though it is not officially supported. It is a
big part of the community and the appeal of Arch. This is a story how the AUR
can break some things and the reason it is not officially supported.</p><p>It all started with a normal update. In my case I used the AUR helper <a href=https://github.com/Morganamilo/paru><code>paru</code></a>
to update all system packages and all AUR packages. Only <code>obs-studio-tytan652</code>
failed when trying to compile, but I rarely use OBS Studio (it will get fixed,
eventually).</p><h2 id=broken-electron-based-applications>Broken Electron-based Applications<a hidden class=anchor aria-hidden=true href=#broken-electron-based-applications>#</a></h2><p>When I tried to launch my note taking app <a href=https://obsidian.md/>Obsidian</a>, it never started. I
dropped into a shell and tried again.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span>❯ obsidian
</span></span><span style=display:flex><span>/usr/lib/electron25/electron: error while loading shared libraries: libdav1d.so.6: cannot open shared object file: No such file or directory
</span></span></code></pre></div><p>I had seem behavior like this before after an update. When you update your
kernel and you are still running the old kernel. If the running (old) kernel
needs to load a new module it expects the old libraries but cannot find them as
only the new ones are available.</p><p>It is generally also a bad idea to symlink libraries. If you would symlink the
old library to the location of the old one, there is no guarantee that they are
even remotely compatible.</p><blockquote><p><strong>Tip 1</strong>: Don&rsquo;t break your system with symlinking shared libraries.</p></blockquote><p>For the new-kernel-old-module problem a reboot usually suffices. However,
electron apps would probably not use any kernel shared libraries. To make sure
anyways, I did reboot.</p><blockquote><p><strong>Tip 2</strong>: Reboot after a upgrade if libraries cannot be found.</p></blockquote><p>After the reboot I was still not able to launch Obsidian or any other
Electron-based app.</p><blockquote><p><strong>Electron</strong> is a framework for building desktop applications. It uses the
Chromium browser engine and Node.js to make it easy to build cross-platform
applications — especially, if you are already familiar with building web apps.</p></blockquote><h2 id=what-is-actually-missing-and-where-should-it-come-from>What is Actually Missing and Where Should it Come From?<a hidden class=anchor aria-hidden=true href=#what-is-actually-missing-and-where-should-it-come-from>#</a></h2><p>Since the issue seems to come from [electon] and not Obsidian itself I looked at
electron directly which yielded the same error.</p><p>When looking for library dependencies for the command <code>electron</code>, there are two
red herrings. One is, that the package <code>electron</code> is only a meta package to
<a href="https://gitlab.archlinux.org/archlinux/packaging/packages/electron/-/blob/main/PKGBUILD?ref_type=heads">link to the latest stable version of electron</a> The second red herring is that
<code>/usr/bin/electron25</code> is a shell script to exec <code>/usr/lib/electron25/electron</code>.
So to check for the shared library dependencies, we can follow the trail like
this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span>❯ which electron
</span></span><span style=display:flex><span>/usr/bin/electron
</span></span><span style=display:flex><span>❯ ls -l /usr/bin/electron
</span></span><span style=display:flex><span>lrwxrwxrwx 1 root root 10 Jun 16 08:50 /usr/bin/electron -&gt; electron25
</span></span><span style=display:flex><span>❯ file /usr/bin/electron25
</span></span><span style=display:flex><span>/usr/bin/electron25: Bourne-Again shell script, ASCII text executable
</span></span><span style=display:flex><span>❯ cat /usr/bin/electron25
</span></span><span style=display:flex><span>#!/usr/bin/bash
</span></span><span style=display:flex><span>[…snip…]
</span></span><span style=display:flex><span>name=electron25
</span></span><span style=display:flex><span>[…snip…]
</span></span><span style=display:flex><span>exec /usr/lib/${name}/electron &#34;${flags[@]}&#34; &#34;$@&#34;
</span></span><span style=display:flex><span>❯ file /usr/lib/electron25/electron
</span></span><span style=display:flex><span>/usr/lib/electron25/electron: ELF 64-bit LSB pie executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, for GNU/Linux 4.4.0, BuildID[sha1]=adabc98fbf2c1422ad6b6c4de371150f4fe605aa, stripped
</span></span></code></pre></div><blockquote><p><strong>Tip 3</strong>: Find the binary that is actually run.</p></blockquote><p>To find the libraries you can run <code>ldd</code> and filtered for the library name.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span>❯ ldd /usr/lib/electron25/electron | grep libdav1d
</span></span><span style=display:flex><span>	libdav1d.so.7 =&gt; /usr/lib/libdav1d.so.7 (0x00007f41ea424000)
</span></span><span style=display:flex><span>❯ ls -l /usr/lib/libdav1d.so.7
</span></span><span style=display:flex><span>lrwxrwxrwx 1 root root 17 Oct  4 17:21 /usr/lib/libdav1d.so.7 -&gt; libdav1d.so.7.0.0
</span></span><span style=display:flex><span>❯ pacman -F /usr/lib/libdav1d.so.7
</span></span><span style=display:flex><span>usr/lib/libdav1d.so.7 is owned by extra/dav1d 1.3.0-1
</span></span></code></pre></div><p>Let&rsquo;s walk through this. The binary wants <code>libdav1d.so.7</code> and it can be found in
<code>/usr/lib/</code>. The way this resolution from filename to path works is similar to
how the <code>PATH</code> variable works. If you want to learn more about where libraries
live, search for <code>LS_LIBRARY_PATH</code> and <code>ld</code>. For now, it is enough to know that
the library is present at a know location, and points to another (existing)
file.</p><p>But actually this library is not the one the error complains about. In the error
above it complained about <code>libdav1d.so.6</code> being absent.</p><p>I reached out to the Arch Linux Mailing List which was very helpful. With the
help of <code>lddtree</code> (from the package <code>pax-utils</code>) I could look recursively at the
required libraries. Again, I filtered for the relevant library name but show 5
lines above the matches to see potential parent dependencies.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span>❯ lddtree /usr/lib/electron25/electron | grep -B5 libdav1d
</span></span><span style=display:flex><span>    libavcodec.so.60 =&gt; /usr/lib/libavcodec.so.60
</span></span><span style=display:flex><span>        libswresample.so.4 =&gt; /usr/lib/libswresample.so.4
</span></span><span style=display:flex><span>            libsoxr.so.0 =&gt; /usr/lib/libsoxr.so.0
</span></span><span style=display:flex><span>                libgomp.so.1 =&gt; /usr/lib/libgomp.so.1
</span></span><span style=display:flex><span>        libvpx.so.8 =&gt; /usr/lib/libvpx.so.8
</span></span><span style=display:flex><span>        libdav1d.so.6 =&gt; None
</span></span><span style=display:flex><span>--
</span></span><span style=display:flex><span>        libva-x11.so.2 =&gt; /usr/lib/libva-x11.so.2
</span></span><span style=display:flex><span>            libX11-xcb.so.1 =&gt; /usr/lib/libX11-xcb.so.1
</span></span><span style=display:flex><span>            libxcb-dri3.so.0 =&gt; /usr/lib/libxcb-dri3.so.0
</span></span><span style=display:flex><span>        libvdpau.so.1 =&gt; /usr/lib/libvdpau.so.1
</span></span><span style=display:flex><span>        libOpenCL.so.1 =&gt; /usr/lib/libOpenCL.so.1
</span></span><span style=display:flex><span>    libdav1d.so.7 =&gt; /usr/lib/libdav1d.so.7
</span></span></code></pre></div><p>This still shows <code>libdav1d.so.7</code> at the root level of the dependencies but also
<code>libdav1d.so.6</code> as dependency of <code>libavcodec.so.60</code>. It cannot resolve the name
to a library location so <code>None</code> gets displayed.</p><p>So where is this library from?</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span>❯ pacman -F libavcodec.so.60
</span></span><span style=display:flex><span>extra/ffmpeg 2:6.0-12
</span></span><span style=display:flex><span>    usr/lib/libavcodec.so.60
</span></span><span style=display:flex><span>❯ pacman -Qi ffmpeg |grep -e Name -e Prov -e Requi
</span></span><span style=display:flex><span>Name            : ffmpeg-obs
</span></span><span style=display:flex><span>Provides        : ffmpeg=6.0.r12.ga6dc929  libavcodec.so=60-64  libavdevice.so=60-64  libavfilter.so=9-64  libavformat.so=60-64  libavutil.so=58-64  libpostproc.so=57-64  libswresample.so=4-64  libswscale.so=7-64
</span></span><span style=display:flex><span>Required By     : chromaprint  chromium  electron25  ferdium-bin  firefox  gst-libav  krita  obs-studio-tytan652  opencv  peek  qt5-webengine  telegram-desktop  thunderbird  vlc-luajit
</span></span></code></pre></div><p>Hm, do you notice something?</p><blockquote><p><strong>Tip 4</strong>: You can use <code>ldd</code>, <code>lddtree</code> (<code>pax-utils</code>) to find shared library
dependencies that a binary need (is linked against).</p></blockquote><blockquote><p><strong>Tip 5</strong>: You can use <code>pacman -F</code> to find the package for file and <code>pacman -Qi</code> to show information about a package, like actual name or which other
packages require it.</p></blockquote><h2 id=the-culprit>The Culprit<a hidden class=anchor aria-hidden=true href=#the-culprit>#</a></h2><p>The library is provided by <code>ffmpeg</code> a widely used library for decoding of all
kinds of media. But the installed version is not the regular version from the
official arch (extra) repositories but <a href=https://aur.archlinux.org/packages/ffmpeg-obs><code>ffmpeg-obs</code></a>, a version from the AUR
which is required by <a href=https://aur.archlinux.org/packages/obs-studio-tytan652><code>obs-studio-tytan652</code></a>.</p><p>So why is it broken? Every time a library is updated, every program that uses
it, needs to also be rebuilt to link against the latest version. If you are
running only official packages from Arch Linux they take good care that if one
library gets an update every program or library using it (recursively) will be
updated as well to reflect the changed version. This is the reason why a
<a href=https://wiki.archlinux.org/title/system_maintenance#Partial_upgrades_are_unsupported>partially upgraded system is unsupported</a>. They cannot guarantee that the
libraries match up.</p><p>The AUR on the other hand is independent from the official package repositories.
If something changes in the official repos, the AUR package maintainer need to
notice and react to it. If it is a binary package, they need to rebuild it
themselves. If it is a package built from source it needs to be rebuilt on the
users machine as well as soon as the new libraries are available (can also be
done through a version increment, e.g. increase the suffix to <code>-2</code>).</p><p>At this point I had two options.</p><ol><li>Remove <code>obs-studio-tytan652</code> and switch back to <code>extra/ffmpeg</code> (the
officially) supported version</li><li>Rebuilt <code>ffmpeg-obs</code> to link against the latest version of <code>dav1d</code>.</li></ol><p>When I realised what had happened there was already <a href="https://aur.archlinux.org/cgit/aur.git/commit/?h=ffmpeg-obs&amp;id=8286e7cda14aaa87f9075174fa475907d99ce6bd">a new version</a> of
<code>ffmpeg-obs</code>. But I will keep this in mind for future updates.</p><h2 id=conclusion>Conclusion<a hidden class=anchor aria-hidden=true href=#conclusion>#</a></h2><p>If this error had happened in an AUR package I would have known that I probably
had to rebuild it to link to the new dependencies. In this case however, one
package in the dependency chain was replaced by an unofficial one. Which made it
less obvious to track down the issue.</p><blockquote><p><strong>Tip 6</strong>: Be weary what packages you replace with packages from the AUR.</p></blockquote></div><footer class=post-footer></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://www.relg.uk/>relg.uk</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>