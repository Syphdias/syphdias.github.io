<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>First and Last Business Day of the Month With Systemd Timers | relg.uk</title>
<meta name=keywords content><meta name=description content="I recently was looking for a way to run a systemd service on the last business
day of the month, but I could only find an answer for first business day of
every month on Stack Overflow which was wrong. So I looked into it.
Spoiler: This is not possible with one calendar expression.
If you remember only one thing from this blog post, remember
systemd-analyse. There are quite a few useful subcommands, e.g. verify.
You should check them out, if you do not know them yet with systemd-analyse -h."><meta name=author content><link rel=canonical href=https://www.relg.uk/posts/first-and-last-business-day-of-the-month-with-systemd-timers/><link crossorigin=anonymous href=/assets/css/stylesheet.f49d66caae9ea0fd43f21f29e71a8d3e284517ed770f2aa86fa012953ad3c9ef.css integrity="sha256-9J1myq6eoP1D8h8p5xqNPihFF+13Dyqob6ASlTrTye8=" rel="preload stylesheet" as=style><link rel=icon href=https://www.relg.uk/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://www.relg.uk/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://www.relg.uk/favicon-32x32.png><link rel=apple-touch-icon href=https://www.relg.uk/apple-touch-icon.png><link rel=mask-icon href=https://www.relg.uk/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://www.relg.uk/posts/first-and-last-business-day-of-the-month-with-systemd-timers/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="https://www.relg.uk/posts/first-and-last-business-day-of-the-month-with-systemd-timers/"><meta property="og:site_name" content="relg.uk"><meta property="og:title" content="First and Last Business Day of the Month With Systemd Timers"><meta property="og:description" content="I recently was looking for a way to run a systemd service on the last business day of the month, but I could only find an answer for first business day of every month on Stack Overflow which was wrong. So I looked into it.
Spoiler: This is not possible with one calendar expression.
If you remember only one thing from this blog post, remember systemd-analyse. There are quite a few useful subcommands, e.g. verify. You should check them out, if you do not know them yet with systemd-analyse -h."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-03-14T00:00:48+01:00"><meta property="article:modified_time" content="2023-03-14T00:00:48+01:00"><meta name=fediverse:creator content="@syphdias@social.linux.pizza"><meta name=twitter:card content="summary"><meta name=twitter:title content="First and Last Business Day of the Month With Systemd Timers"><meta name=twitter:description content="I recently was looking for a way to run a systemd service on the last business
day of the month, but I could only find an answer for first business day of
every month on Stack Overflow which was wrong. So I looked into it.
Spoiler: This is not possible with one calendar expression.
If you remember only one thing from this blog post, remember
systemd-analyse. There are quite a few useful subcommands, e.g. verify.
You should check them out, if you do not know them yet with systemd-analyse -h."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://www.relg.uk/posts/"},{"@type":"ListItem","position":2,"name":"First and Last Business Day of the Month With Systemd Timers","item":"https://www.relg.uk/posts/first-and-last-business-day-of-the-month-with-systemd-timers/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"First and Last Business Day of the Month With Systemd Timers","name":"First and Last Business Day of the Month With Systemd Timers","description":"I recently was looking for a way to run a systemd service on the last business day of the month, but I could only find an answer for first business day of every month on Stack Overflow which was wrong. So I looked into it.\nSpoiler: This is not possible with one calendar expression.\nIf you remember only one thing from this blog post, remember systemd-analyse. There are quite a few useful subcommands, e.g. verify. You should check them out, if you do not know them yet with systemd-analyse -h.\n","keywords":[],"articleBody":"I recently was looking for a way to run a systemd service on the last business day of the month, but I could only find an answer for first business day of every month on Stack Overflow which was wrong. So I looked into it.\nSpoiler: This is not possible with one calendar expression.\nIf you remember only one thing from this blog post, remember systemd-analyse. There are quite a few useful subcommands, e.g. verify. You should check them out, if you do not know them yet with systemd-analyse -h.\nFor timers, we want systemd-analyse calendar.\nFirst Business Day of the Month To achieve this we can set OnCalendar twice in the timer unit, we do not need two timer units:\n[Timer] OnCalendar=Mon..Fri *-*-01 OnCalendar=Mon *-*-02..03 Mon..Fri *-*-01 will activate if the first day of the month is a business day Mon *-*-02..03 will activate if the second or third day of the month is a Monday. This happens if the first was a Sunday, or if the first was a Saturday and the second was a Sunday. There is no overlap. To verify this is true we can use (--iterations is optional but very useful):\nsystemd-analyze calendar 'Mon..Fri *-*-01' 'Mon *-*-02..03' --iterations 10 The output is a bit unwieldy since it treats both expressions separately and prints three versions of the iterations.\nsystemd-analyze calendar 'Mon..Fri *-*-01' 'Mon *-*-02..03' --iterations 10 \\ |grep Iteration |sort -k4 This works for a English locale but it will filter out the first iteration because it is listed as “Next elapse”. The get a good overview in this case it suffices.\nLast Business Day of the Month Last day is very similar to first day, but requires dates that were introduced in systemd v233. Again, we need two expressions:\n[Timer] OnCalendar=Mon..Fri *-*~01 OnCalendar=Fri *-*~02..03 Mon..Fri *-*~01 triggers if the last day of the month is a business day Fri *-*~02..03 triggers if the second to last or third to last day of the month was a Friday. This happens if the weekend is on the last day of the month. Verifying this works just the same:\nsystemd-analyze calendar 'Mon..Fri *-*~01' 'Fri *-*~02..03' --iterations 10 Optionally, filter and sort with the caveats from above:\nsystemd-analyze calendar 'Mon..Fri *-*~01' 'Fri *-*~02..03' --iterations 10 \\ |grep Iteration |sort -k4 ","wordCount":"382","inLanguage":"en","datePublished":"2023-03-14T00:00:48+01:00","dateModified":"2023-03-14T00:00:48+01:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.relg.uk/posts/first-and-last-business-day-of-the-month-with-systemd-timers/"},"publisher":{"@type":"Organization","name":"relg.uk","logo":{"@type":"ImageObject","url":"https://www.relg.uk/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark"),document.addEventListener("DOMContentLoaded",function(){sessionStorage.getItem("nthLoad")?(document.getElementById("logo").classList.remove("logo-first-load"),document.getElementById("logo").classList.add("logo-nth-load")):sessionStorage.setItem("nthLoad","true")})</script><style>.logo{display:flex;font-family:MesloLGS NF,monospace;font-size:2em;cursor:pointer}.logo span{display:inline-block}.logo-first-load span{animation-delay:1s}@keyframes char1{0%{transform:translateX(0)}100%{transform:translateX(5ch)}}@keyframes char2{0%{transform:translateX(0)}100%{transform:translateX(3ch)}}@keyframes char3{0%{transform:translateX(0)}100%{transform:translateX(1ch)}}@keyframes char4{0%{transform:translateX(0)}100%{transform:translateX(-1ch)}}@keyframes char5{0%{transform:translateX(0);opacity:1}100%{transform:translateX(-2ch);opacity:0}}@keyframes char6{0%{transform:translateX(0)}100%{transform:translateX(-4ch)}}@keyframes char7{0%{transform:translateX(0)}100%{transform:translateX(-6ch)}}.logo-first-load span:nth-child(1){animation:char1 .5s ease 1s forwards}.logo-first-load span:nth-child(2){animation:char2 .5s ease 1s forwards}.logo-first-load span:nth-child(3){animation:char3 .5s ease 1s forwards}.logo-first-load span:nth-child(4){animation:char4 .5s ease 1s forwards}.logo-first-load span:nth-child(5){animation:char5 .5s ease 1s forwards}.logo-first-load span:nth-child(6){animation:char6 .5s ease 1s forwards}.logo-first-load span:nth-child(7){animation:char7 .5s ease 1s forwards}@keyframes char1r{0%{transform:translateX(5ch)}100%{transform:translateX(0)}}@keyframes char2r{0%{transform:translateX(3ch)}100%{transform:translateX(0)}}@keyframes char3r{0%{transform:translateX(1ch)}100%{transform:translateX(0)}}@keyframes char4r{0%{transform:translateX(-1ch)}100%{transform:translateX(0)}}@keyframes char5r{0%{transform:translateX(-2ch);opacity:0}100%{transform:translateX(0);opacity:1}}@keyframes char6r{0%{transform:translateX(-4ch)}100%{transform:translateX(0)}}@keyframes char7r{0%{transform:translateX(-6ch)}100%{transform:translateX(0)}}.logo-first-load:hover span{animation-delay:0s}.logo-first-load:hover span:nth-child(1){animation-name:char1r}.logo-first-load:hover span:nth-child(2){animation-name:char2r}.logo-first-load:hover span:nth-child(3){animation-name:char3r}.logo-first-load:hover span:nth-child(4){animation-name:char4r}.logo-first-load:hover span:nth-child(5){animation-name:char5r}.logo-first-load:hover span:nth-child(6){animation-name:char6r}.logo-first-load:hover span:nth-child(7){animation-name:char7r}.logo-nth-load span{transition:transform .5s ease,opacity .5s ease}.logo-nth-load:hover span:nth-child(1){transform:translateX(5ch)}.logo-nth-load:hover span:nth-child(2){transform:translateX(3ch)}.logo-nth-load:hover span:nth-child(3){transform:translateX(1ch)}.logo-nth-load:hover span:nth-child(4){transform:translateX(-1ch)}.logo-nth-load:hover span:nth-child(5){transform:translateX(-2ch);opacity:0}.logo-nth-load:hover span:nth-child(6){transform:translateX(-4ch)}.logo-nth-load:hover span:nth-child(7){transform:translateX(-6ch)}</style><header class=header><nav class=nav><div id=logo class="logo logo-first-load"><a href=https://www.relg.uk/ accesskey=h title="relg.uk (Alt + H)"><span>r</span><span>e</span><span>l</span><span>g</span><span>.</span><span>u</span><span>k</span></a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://www.relg.uk/search/ title="search (Alt + /)" accesskey=/><span><img src=/magnifying-glass-solid.svg alt=search style=height:1em;width:1em;display:inline-block;margin-right:.3em;vertical-align:middle>
search</span></a></li><li><a href=https://www.relg.uk/archives/ title=archive><span><img src=/box-archive-solid.svg alt=archive style=height:1em;width:1em;display:inline-block;margin-right:.3em;vertical-align:middle>
archive</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">First and Last Business Day of the Month With Systemd Timers</h1><div class=post-meta><span title='2023-03-14 00:00:48 +0100 +0100'>2023-03-14</span>&nbsp;·&nbsp;2 min&nbsp;|&nbsp;<a href=https://github.com/syphdias/syphdias.github.io/edit/main/content/posts/first-and-last-business-day-of-the-month-with-systemd-timers.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=post-content><p>I recently was looking for a way to run a systemd service on the last business
day of the month, but I could only find an answer for first business day of
every month on Stack Overflow which was wrong. So I looked into it.</p><p>Spoiler: This is not possible with one calendar expression.</p><p>If you remember only one thing from this blog post, <strong>remember
<code>systemd-analyse</code></strong>. There are quite a few useful subcommands, e.g. <code>verify</code>.
You should check them out, if you do not know them yet with <code>systemd-analyse -h</code>.</p><p>For timers, we want <code>systemd-analyse calendar</code>.</p><h2 id=first-business-day-of-the-month>First Business Day of the Month<a hidden class=anchor aria-hidden=true href=#first-business-day-of-the-month>#</a></h2><p>To achieve this we can set <code>OnCalendar</code> twice in the timer unit, we do not need
two timer units:</p><pre tabindex=0><code>[Timer]
OnCalendar=Mon..Fri *-*-01
OnCalendar=Mon *-*-02..03
</code></pre><ul><li><code>Mon..Fri *-*-01</code> will activate if the first day of the month is a business
day</li><li><code>Mon *-*-02..03</code> will activate if the second or third day of the month is a
Monday. This happens if the first was a Sunday, or if the first was a Saturday
and the second was a Sunday. There is no overlap.</li></ul><p>To verify this is true we can use (<code>--iterations</code> is optional but very useful):</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>systemd-analyze calendar <span style=color:#e6db74>&#39;Mon..Fri *-*-01&#39;</span> <span style=color:#e6db74>&#39;Mon *-*-02..03&#39;</span> --iterations <span style=color:#ae81ff>10</span>
</span></span></code></pre></div><p>The output is a bit unwieldy since it treats both expressions separately and
prints three versions of the iterations.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>systemd-analyze calendar <span style=color:#e6db74>&#39;Mon..Fri *-*-01&#39;</span> <span style=color:#e6db74>&#39;Mon *-*-02..03&#39;</span> --iterations <span style=color:#ae81ff>10</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    |grep Iteration |sort -k4
</span></span></code></pre></div><p>This works for a English locale but it will filter out the first iteration
because it is listed as &ldquo;Next elapse&rdquo;. The get a good overview in this case it
suffices.</p><h2 id=last-business-day-of-the-month>Last Business Day of the Month<a hidden class=anchor aria-hidden=true href=#last-business-day-of-the-month>#</a></h2><p>Last day is very similar to first day, but requires dates that were introduced
in <a href=https://github.com/systemd/systemd/blob/v233/NEWS#L174>systemd v233</a>. Again, we need two expressions:</p><pre tabindex=0><code>[Timer]
OnCalendar=Mon..Fri *-*~01
OnCalendar=Fri *-*~02..03
</code></pre><ul><li><code>Mon..Fri *-*~01</code> triggers if the last day of the month is a business day</li><li><code>Fri *-*~02..03</code> triggers if the second to last or third to last day of the
month was a Friday. This happens if the weekend is on the last day of the
month.</li></ul><p>Verifying this works just the same:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>systemd-analyze calendar <span style=color:#e6db74>&#39;Mon..Fri *-*~01&#39;</span> <span style=color:#e6db74>&#39;Fri *-*~02..03&#39;</span> --iterations <span style=color:#ae81ff>10</span>
</span></span></code></pre></div><p>Optionally, filter and sort with the caveats from above:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>systemd-analyze calendar <span style=color:#e6db74>&#39;Mon..Fri *-*~01&#39;</span> <span style=color:#e6db74>&#39;Fri *-*~02..03&#39;</span> --iterations <span style=color:#ae81ff>10</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    |grep Iteration |sort -k4
</span></span></code></pre></div></div><footer class=post-footer><ul class=post-tags></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://www.relg.uk/>relg.uk</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>